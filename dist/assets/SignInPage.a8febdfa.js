import{by as g,bF as w,bx as m,bR as C,bQ as F,bt as k,bE as e,bU as f}from"./vendor.cc682980.js";import{u as I,B as N,I as j,b as q,F as c,a as D,M,v as O,c as E,h as b}from"./index.f7c8a6df.js";import"./vant.89ecb901.js";const L=u=>{const t=g(u);return{ref:t,toggle:()=>t.value=!t.value,on:()=>t.value=!0,off:()=>t.value=!1}},P="_logo_ly99d_1",R="_icon_ly99d_8",T="_appName_ly99d_12",r={logo:P,icon:R,appName:T},G=w({setup:(u,t)=>{const y=I(),o=m({email:"",code:""}),s=m({email:[],code:[]}),d=g(),{ref:v,toggle:U,on:h,off:_}=L(!1),x=C(),i=F(),B=async a=>{var l;if(a.preventDefault(),Object.assign(s,{email:[],code:[]}),Object.assign(s,O(o,[{key:"email",type:"required",message:"\u5FC5\u586B"},{key:"email",type:"pattern",regex:/.+@.+/,message:"\u5FC5\u987B\u662F\u90AE\u7BB1\u5730\u5740"},{key:"code",type:"required",message:"\u5FC5\u586B"}])),!E(s)){const n=await b.post("/session",o,{_autoLoading:!0}).catch(p);localStorage.setItem("jwt",n.data.jwt);const V=(l=i.query.return_to)==null?void 0:l.toString();y.refreshMe(),x.push(V||"/")}},p=a=>{throw a.response.status===422&&Object.assign(s,a.response.data.errors),a},S=async()=>{h(),await b.post("/validation_codes",{email:o.email},{_autoLoading:!0}).catch(p).finally(_),d.value.startCount()};return k(()=>{const a=i.fullPath.indexOf("?");i.fullPath.slice(a+1)==="preview=yes"&&(o.email="1055824818@qq.com",o.code="123456")}),()=>e(M,null,{title:()=>"\u767B\u5F55",icon:()=>e(N,null,null),default:()=>e("div",{class:r.wrapper},[e("div",{class:r.logo},[e(j,{class:r.icon,name:"life"},null),e("h1",{class:r.appName},[f("\u751F\u6D3B\u8BB0\u8D26")])]),e(q,{onSubmit:B},{default:()=>{var a,l;return[e(c,{label:"\u90AE\u7BB1\u5730\u5740",type:"text",placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1\uFF0C\u7136\u540E\u70B9\u51FB\u53D1\u9001\u9A8C\u8BC1\u7801",modelValue:o.email,"onUpdate:modelValue":n=>o.email=n,error:(a=s.email)==null?void 0:a[0]},null),e(c,{ref:d,label:"\u9A8C\u8BC1\u7801",type:"validationCode",placeholder:"\u8BF7\u8F93\u5165\u516D\u4F4D\u6570\u5B57",countFrom:1,disabled:v.value,onClick:S,modelValue:o.code,"onUpdate:modelValue":n=>o.code=n,error:(l=s.code)==null?void 0:l[0]},null),e(c,{style:{paddingTop:"96px"}},{default:()=>[e(D,{type:"submit"},{default:()=>[f("\u767B\u5F55")]})]})]}})])})}});export{G as SignInPage,G as default};
